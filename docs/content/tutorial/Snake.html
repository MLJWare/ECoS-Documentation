<!DOCTYPE html>
    <html>
    <head>
        <meta charset="UTF-8">
        <title>Tutorial&colon; Snake</title>
        <style>
/* From extension vscode.github */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.vscode-dark img[src$=\#gh-light-mode-only],
.vscode-light img[src$=\#gh-dark-mode-only] {
	display: none;
}

/* From extension vscode.markdown-math */
@font-face{font-family:KaTeX_AMS;font-style:normal;font-weight:400;src:url(fonts/KaTeX_AMS-Regular.woff2) format("woff2"),url(fonts/KaTeX_AMS-Regular.woff) format("woff"),url(fonts/KaTeX_AMS-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Caligraphic-Bold.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Bold.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Caligraphic;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Caligraphic-Regular.woff2) format("woff2"),url(fonts/KaTeX_Caligraphic-Regular.woff) format("woff"),url(fonts/KaTeX_Caligraphic-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Fraktur-Bold.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Bold.woff) format("woff"),url(fonts/KaTeX_Fraktur-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Fraktur;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Fraktur-Regular.woff2) format("woff2"),url(fonts/KaTeX_Fraktur-Regular.woff) format("woff"),url(fonts/KaTeX_Fraktur-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:700;src:url(fonts/KaTeX_Main-Bold.woff2) format("woff2"),url(fonts/KaTeX_Main-Bold.woff) format("woff"),url(fonts/KaTeX_Main-Bold.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Main-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Main-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Main-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Main-Italic.woff2) format("woff2"),url(fonts/KaTeX_Main-Italic.woff) format("woff"),url(fonts/KaTeX_Main-Italic.ttf) format("truetype")}@font-face{font-family:KaTeX_Main;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Main-Regular.woff2) format("woff2"),url(fonts/KaTeX_Main-Regular.woff) format("woff"),url(fonts/KaTeX_Main-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:700;src:url(fonts/KaTeX_Math-BoldItalic.woff2) format("woff2"),url(fonts/KaTeX_Math-BoldItalic.woff) format("woff"),url(fonts/KaTeX_Math-BoldItalic.ttf) format("truetype")}@font-face{font-family:KaTeX_Math;font-style:italic;font-weight:400;src:url(fonts/KaTeX_Math-Italic.woff2) format("woff2"),url(fonts/KaTeX_Math-Italic.woff) format("woff"),url(fonts/KaTeX_Math-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:700;src:url(fonts/KaTeX_SansSerif-Bold.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Bold.woff) format("woff"),url(fonts/KaTeX_SansSerif-Bold.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:italic;font-weight:400;src:url(fonts/KaTeX_SansSerif-Italic.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Italic.woff) format("woff"),url(fonts/KaTeX_SansSerif-Italic.ttf) format("truetype")}@font-face{font-family:"KaTeX_SansSerif";font-style:normal;font-weight:400;src:url(fonts/KaTeX_SansSerif-Regular.woff2) format("woff2"),url(fonts/KaTeX_SansSerif-Regular.woff) format("woff"),url(fonts/KaTeX_SansSerif-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Script;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Script-Regular.woff2) format("woff2"),url(fonts/KaTeX_Script-Regular.woff) format("woff"),url(fonts/KaTeX_Script-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size1;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size1-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size1-Regular.woff) format("woff"),url(fonts/KaTeX_Size1-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size2;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size2-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size2-Regular.woff) format("woff"),url(fonts/KaTeX_Size2-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size3;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size3-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size3-Regular.woff) format("woff"),url(fonts/KaTeX_Size3-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Size4;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Size4-Regular.woff2) format("woff2"),url(fonts/KaTeX_Size4-Regular.woff) format("woff"),url(fonts/KaTeX_Size4-Regular.ttf) format("truetype")}@font-face{font-family:KaTeX_Typewriter;font-style:normal;font-weight:400;src:url(fonts/KaTeX_Typewriter-Regular.woff2) format("woff2"),url(fonts/KaTeX_Typewriter-Regular.woff) format("woff"),url(fonts/KaTeX_Typewriter-Regular.ttf) format("truetype")}.katex{text-rendering:auto;font:normal 1.21em KaTeX_Main,Times New Roman,serif;line-height:1.2;text-indent:0}.katex *{-ms-high-contrast-adjust:none!important;border-color:currentColor}.katex .katex-version:after{content:"0.13.24"}.katex .katex-mathml{clip:rect(1px,1px,1px,1px);border:0;height:1px;overflow:hidden;padding:0;position:absolute;width:1px}.katex .katex-html>.newline{display:block}.katex .base{position:relative;white-space:nowrap;width:-webkit-min-content;width:-moz-min-content;width:min-content}.katex .base,.katex .strut{display:inline-block}.katex .textbf{font-weight:700}.katex .textit{font-style:italic}.katex .textrm{font-family:KaTeX_Main}.katex .textsf{font-family:KaTeX_SansSerif}.katex .texttt{font-family:KaTeX_Typewriter}.katex .mathnormal{font-family:KaTeX_Math;font-style:italic}.katex .mathit{font-family:KaTeX_Main;font-style:italic}.katex .mathrm{font-style:normal}.katex .mathbf{font-family:KaTeX_Main;font-weight:700}.katex .boldsymbol{font-family:KaTeX_Math;font-style:italic;font-weight:700}.katex .amsrm,.katex .mathbb,.katex .textbb{font-family:KaTeX_AMS}.katex .mathcal{font-family:KaTeX_Caligraphic}.katex .mathfrak,.katex .textfrak{font-family:KaTeX_Fraktur}.katex .mathtt{font-family:KaTeX_Typewriter}.katex .mathscr,.katex .textscr{font-family:KaTeX_Script}.katex .mathsf,.katex .textsf{font-family:KaTeX_SansSerif}.katex .mathboldsf,.katex .textboldsf{font-family:KaTeX_SansSerif;font-weight:700}.katex .mathitsf,.katex .textitsf{font-family:KaTeX_SansSerif;font-style:italic}.katex .mainrm{font-family:KaTeX_Main;font-style:normal}.katex .vlist-t{border-collapse:collapse;display:inline-table;table-layout:fixed}.katex .vlist-r{display:table-row}.katex .vlist{display:table-cell;position:relative;vertical-align:bottom}.katex .vlist>span{display:block;height:0;position:relative}.katex .vlist>span>span{display:inline-block}.katex .vlist>span>.pstrut{overflow:hidden;width:0}.katex .vlist-t2{margin-right:-2px}.katex .vlist-s{display:table-cell;font-size:1px;min-width:2px;vertical-align:bottom;width:2px}.katex .vbox{align-items:baseline;display:inline-flex;flex-direction:column}.katex .hbox{width:100%}.katex .hbox,.katex .thinbox{display:inline-flex;flex-direction:row}.katex .thinbox{max-width:0;width:0}.katex .msupsub{text-align:left}.katex .mfrac>span>span{text-align:center}.katex .mfrac .frac-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline,.katex .hline,.katex .mfrac .frac-line,.katex .overline .overline-line,.katex .rule,.katex .underline .underline-line{min-height:1px}.katex .mspace{display:inline-block}.katex .clap,.katex .llap,.katex .rlap{position:relative;width:0}.katex .clap>.inner,.katex .llap>.inner,.katex .rlap>.inner{position:absolute}.katex .clap>.fix,.katex .llap>.fix,.katex .rlap>.fix{display:inline-block}.katex .llap>.inner{right:0}.katex .clap>.inner,.katex .rlap>.inner{left:0}.katex .clap>.inner>span{margin-left:-50%;margin-right:50%}.katex .rule{border:0 solid;display:inline-block;position:relative}.katex .hline,.katex .overline .overline-line,.katex .underline .underline-line{border-bottom-style:solid;display:inline-block;width:100%}.katex .hdashline{border-bottom-style:dashed;display:inline-block;width:100%}.katex .sqrt>.root{margin-left:.27777778em;margin-right:-.55555556em}.katex .fontsize-ensurer.reset-size1.size1,.katex .sizing.reset-size1.size1{font-size:1em}.katex .fontsize-ensurer.reset-size1.size2,.katex .sizing.reset-size1.size2{font-size:1.2em}.katex .fontsize-ensurer.reset-size1.size3,.katex .sizing.reset-size1.size3{font-size:1.4em}.katex .fontsize-ensurer.reset-size1.size4,.katex .sizing.reset-size1.size4{font-size:1.6em}.katex .fontsize-ensurer.reset-size1.size5,.katex .sizing.reset-size1.size5{font-size:1.8em}.katex .fontsize-ensurer.reset-size1.size6,.katex .sizing.reset-size1.size6{font-size:2em}.katex .fontsize-ensurer.reset-size1.size7,.katex .sizing.reset-size1.size7{font-size:2.4em}.katex .fontsize-ensurer.reset-size1.size8,.katex .sizing.reset-size1.size8{font-size:2.88em}.katex .fontsize-ensurer.reset-size1.size9,.katex .sizing.reset-size1.size9{font-size:3.456em}.katex .fontsize-ensurer.reset-size1.size10,.katex .sizing.reset-size1.size10{font-size:4.148em}.katex .fontsize-ensurer.reset-size1.size11,.katex .sizing.reset-size1.size11{font-size:4.976em}.katex .fontsize-ensurer.reset-size2.size1,.katex .sizing.reset-size2.size1{font-size:.83333333em}.katex .fontsize-ensurer.reset-size2.size2,.katex .sizing.reset-size2.size2{font-size:1em}.katex .fontsize-ensurer.reset-size2.size3,.katex .sizing.reset-size2.size3{font-size:1.16666667em}.katex .fontsize-ensurer.reset-size2.size4,.katex .sizing.reset-size2.size4{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size2.size5,.katex .sizing.reset-size2.size5{font-size:1.5em}.katex .fontsize-ensurer.reset-size2.size6,.katex .sizing.reset-size2.size6{font-size:1.66666667em}.katex .fontsize-ensurer.reset-size2.size7,.katex .sizing.reset-size2.size7{font-size:2em}.katex .fontsize-ensurer.reset-size2.size8,.katex .sizing.reset-size2.size8{font-size:2.4em}.katex .fontsize-ensurer.reset-size2.size9,.katex .sizing.reset-size2.size9{font-size:2.88em}.katex .fontsize-ensurer.reset-size2.size10,.katex .sizing.reset-size2.size10{font-size:3.45666667em}.katex .fontsize-ensurer.reset-size2.size11,.katex .sizing.reset-size2.size11{font-size:4.14666667em}.katex .fontsize-ensurer.reset-size3.size1,.katex .sizing.reset-size3.size1{font-size:.71428571em}.katex .fontsize-ensurer.reset-size3.size2,.katex .sizing.reset-size3.size2{font-size:.85714286em}.katex .fontsize-ensurer.reset-size3.size3,.katex .sizing.reset-size3.size3{font-size:1em}.katex .fontsize-ensurer.reset-size3.size4,.katex .sizing.reset-size3.size4{font-size:1.14285714em}.katex .fontsize-ensurer.reset-size3.size5,.katex .sizing.reset-size3.size5{font-size:1.28571429em}.katex .fontsize-ensurer.reset-size3.size6,.katex .sizing.reset-size3.size6{font-size:1.42857143em}.katex .fontsize-ensurer.reset-size3.size7,.katex .sizing.reset-size3.size7{font-size:1.71428571em}.katex .fontsize-ensurer.reset-size3.size8,.katex .sizing.reset-size3.size8{font-size:2.05714286em}.katex .fontsize-ensurer.reset-size3.size9,.katex .sizing.reset-size3.size9{font-size:2.46857143em}.katex .fontsize-ensurer.reset-size3.size10,.katex .sizing.reset-size3.size10{font-size:2.96285714em}.katex .fontsize-ensurer.reset-size3.size11,.katex .sizing.reset-size3.size11{font-size:3.55428571em}.katex .fontsize-ensurer.reset-size4.size1,.katex .sizing.reset-size4.size1{font-size:.625em}.katex .fontsize-ensurer.reset-size4.size2,.katex .sizing.reset-size4.size2{font-size:.75em}.katex .fontsize-ensurer.reset-size4.size3,.katex .sizing.reset-size4.size3{font-size:.875em}.katex .fontsize-ensurer.reset-size4.size4,.katex .sizing.reset-size4.size4{font-size:1em}.katex .fontsize-ensurer.reset-size4.size5,.katex .sizing.reset-size4.size5{font-size:1.125em}.katex .fontsize-ensurer.reset-size4.size6,.katex .sizing.reset-size4.size6{font-size:1.25em}.katex .fontsize-ensurer.reset-size4.size7,.katex .sizing.reset-size4.size7{font-size:1.5em}.katex .fontsize-ensurer.reset-size4.size8,.katex .sizing.reset-size4.size8{font-size:1.8em}.katex .fontsize-ensurer.reset-size4.size9,.katex .sizing.reset-size4.size9{font-size:2.16em}.katex .fontsize-ensurer.reset-size4.size10,.katex .sizing.reset-size4.size10{font-size:2.5925em}.katex .fontsize-ensurer.reset-size4.size11,.katex .sizing.reset-size4.size11{font-size:3.11em}.katex .fontsize-ensurer.reset-size5.size1,.katex .sizing.reset-size5.size1{font-size:.55555556em}.katex .fontsize-ensurer.reset-size5.size2,.katex .sizing.reset-size5.size2{font-size:.66666667em}.katex .fontsize-ensurer.reset-size5.size3,.katex .sizing.reset-size5.size3{font-size:.77777778em}.katex .fontsize-ensurer.reset-size5.size4,.katex .sizing.reset-size5.size4{font-size:.88888889em}.katex .fontsize-ensurer.reset-size5.size5,.katex .sizing.reset-size5.size5{font-size:1em}.katex .fontsize-ensurer.reset-size5.size6,.katex .sizing.reset-size5.size6{font-size:1.11111111em}.katex .fontsize-ensurer.reset-size5.size7,.katex .sizing.reset-size5.size7{font-size:1.33333333em}.katex .fontsize-ensurer.reset-size5.size8,.katex .sizing.reset-size5.size8{font-size:1.6em}.katex .fontsize-ensurer.reset-size5.size9,.katex .sizing.reset-size5.size9{font-size:1.92em}.katex .fontsize-ensurer.reset-size5.size10,.katex .sizing.reset-size5.size10{font-size:2.30444444em}.katex .fontsize-ensurer.reset-size5.size11,.katex .sizing.reset-size5.size11{font-size:2.76444444em}.katex .fontsize-ensurer.reset-size6.size1,.katex .sizing.reset-size6.size1{font-size:.5em}.katex .fontsize-ensurer.reset-size6.size2,.katex .sizing.reset-size6.size2{font-size:.6em}.katex .fontsize-ensurer.reset-size6.size3,.katex .sizing.reset-size6.size3{font-size:.7em}.katex .fontsize-ensurer.reset-size6.size4,.katex .sizing.reset-size6.size4{font-size:.8em}.katex .fontsize-ensurer.reset-size6.size5,.katex .sizing.reset-size6.size5{font-size:.9em}.katex .fontsize-ensurer.reset-size6.size6,.katex .sizing.reset-size6.size6{font-size:1em}.katex .fontsize-ensurer.reset-size6.size7,.katex .sizing.reset-size6.size7{font-size:1.2em}.katex .fontsize-ensurer.reset-size6.size8,.katex .sizing.reset-size6.size8{font-size:1.44em}.katex .fontsize-ensurer.reset-size6.size9,.katex .sizing.reset-size6.size9{font-size:1.728em}.katex .fontsize-ensurer.reset-size6.size10,.katex .sizing.reset-size6.size10{font-size:2.074em}.katex .fontsize-ensurer.reset-size6.size11,.katex .sizing.reset-size6.size11{font-size:2.488em}.katex .fontsize-ensurer.reset-size7.size1,.katex .sizing.reset-size7.size1{font-size:.41666667em}.katex .fontsize-ensurer.reset-size7.size2,.katex .sizing.reset-size7.size2{font-size:.5em}.katex .fontsize-ensurer.reset-size7.size3,.katex .sizing.reset-size7.size3{font-size:.58333333em}.katex .fontsize-ensurer.reset-size7.size4,.katex .sizing.reset-size7.size4{font-size:.66666667em}.katex .fontsize-ensurer.reset-size7.size5,.katex .sizing.reset-size7.size5{font-size:.75em}.katex .fontsize-ensurer.reset-size7.size6,.katex .sizing.reset-size7.size6{font-size:.83333333em}.katex .fontsize-ensurer.reset-size7.size7,.katex .sizing.reset-size7.size7{font-size:1em}.katex .fontsize-ensurer.reset-size7.size8,.katex .sizing.reset-size7.size8{font-size:1.2em}.katex .fontsize-ensurer.reset-size7.size9,.katex .sizing.reset-size7.size9{font-size:1.44em}.katex .fontsize-ensurer.reset-size7.size10,.katex .sizing.reset-size7.size10{font-size:1.72833333em}.katex .fontsize-ensurer.reset-size7.size11,.katex .sizing.reset-size7.size11{font-size:2.07333333em}.katex .fontsize-ensurer.reset-size8.size1,.katex .sizing.reset-size8.size1{font-size:.34722222em}.katex .fontsize-ensurer.reset-size8.size2,.katex .sizing.reset-size8.size2{font-size:.41666667em}.katex .fontsize-ensurer.reset-size8.size3,.katex .sizing.reset-size8.size3{font-size:.48611111em}.katex .fontsize-ensurer.reset-size8.size4,.katex .sizing.reset-size8.size4{font-size:.55555556em}.katex .fontsize-ensurer.reset-size8.size5,.katex .sizing.reset-size8.size5{font-size:.625em}.katex .fontsize-ensurer.reset-size8.size6,.katex .sizing.reset-size8.size6{font-size:.69444444em}.katex .fontsize-ensurer.reset-size8.size7,.katex .sizing.reset-size8.size7{font-size:.83333333em}.katex .fontsize-ensurer.reset-size8.size8,.katex .sizing.reset-size8.size8{font-size:1em}.katex .fontsize-ensurer.reset-size8.size9,.katex .sizing.reset-size8.size9{font-size:1.2em}.katex .fontsize-ensurer.reset-size8.size10,.katex .sizing.reset-size8.size10{font-size:1.44027778em}.katex .fontsize-ensurer.reset-size8.size11,.katex .sizing.reset-size8.size11{font-size:1.72777778em}.katex .fontsize-ensurer.reset-size9.size1,.katex .sizing.reset-size9.size1{font-size:.28935185em}.katex .fontsize-ensurer.reset-size9.size2,.katex .sizing.reset-size9.size2{font-size:.34722222em}.katex .fontsize-ensurer.reset-size9.size3,.katex .sizing.reset-size9.size3{font-size:.40509259em}.katex .fontsize-ensurer.reset-size9.size4,.katex .sizing.reset-size9.size4{font-size:.46296296em}.katex .fontsize-ensurer.reset-size9.size5,.katex .sizing.reset-size9.size5{font-size:.52083333em}.katex .fontsize-ensurer.reset-size9.size6,.katex .sizing.reset-size9.size6{font-size:.5787037em}.katex .fontsize-ensurer.reset-size9.size7,.katex .sizing.reset-size9.size7{font-size:.69444444em}.katex .fontsize-ensurer.reset-size9.size8,.katex .sizing.reset-size9.size8{font-size:.83333333em}.katex .fontsize-ensurer.reset-size9.size9,.katex .sizing.reset-size9.size9{font-size:1em}.katex .fontsize-ensurer.reset-size9.size10,.katex .sizing.reset-size9.size10{font-size:1.20023148em}.katex .fontsize-ensurer.reset-size9.size11,.katex .sizing.reset-size9.size11{font-size:1.43981481em}.katex .fontsize-ensurer.reset-size10.size1,.katex .sizing.reset-size10.size1{font-size:.24108004em}.katex .fontsize-ensurer.reset-size10.size2,.katex .sizing.reset-size10.size2{font-size:.28929605em}.katex .fontsize-ensurer.reset-size10.size3,.katex .sizing.reset-size10.size3{font-size:.33751205em}.katex .fontsize-ensurer.reset-size10.size4,.katex .sizing.reset-size10.size4{font-size:.38572806em}.katex .fontsize-ensurer.reset-size10.size5,.katex .sizing.reset-size10.size5{font-size:.43394407em}.katex .fontsize-ensurer.reset-size10.size6,.katex .sizing.reset-size10.size6{font-size:.48216008em}.katex .fontsize-ensurer.reset-size10.size7,.katex .sizing.reset-size10.size7{font-size:.57859209em}.katex .fontsize-ensurer.reset-size10.size8,.katex .sizing.reset-size10.size8{font-size:.69431051em}.katex .fontsize-ensurer.reset-size10.size9,.katex .sizing.reset-size10.size9{font-size:.83317261em}.katex .fontsize-ensurer.reset-size10.size10,.katex .sizing.reset-size10.size10{font-size:1em}.katex .fontsize-ensurer.reset-size10.size11,.katex .sizing.reset-size10.size11{font-size:1.19961427em}.katex .fontsize-ensurer.reset-size11.size1,.katex .sizing.reset-size11.size1{font-size:.20096463em}.katex .fontsize-ensurer.reset-size11.size2,.katex .sizing.reset-size11.size2{font-size:.24115756em}.katex .fontsize-ensurer.reset-size11.size3,.katex .sizing.reset-size11.size3{font-size:.28135048em}.katex .fontsize-ensurer.reset-size11.size4,.katex .sizing.reset-size11.size4{font-size:.32154341em}.katex .fontsize-ensurer.reset-size11.size5,.katex .sizing.reset-size11.size5{font-size:.36173633em}.katex .fontsize-ensurer.reset-size11.size6,.katex .sizing.reset-size11.size6{font-size:.40192926em}.katex .fontsize-ensurer.reset-size11.size7,.katex .sizing.reset-size11.size7{font-size:.48231511em}.katex .fontsize-ensurer.reset-size11.size8,.katex .sizing.reset-size11.size8{font-size:.57877814em}.katex .fontsize-ensurer.reset-size11.size9,.katex .sizing.reset-size11.size9{font-size:.69453376em}.katex .fontsize-ensurer.reset-size11.size10,.katex .sizing.reset-size11.size10{font-size:.83360129em}.katex .fontsize-ensurer.reset-size11.size11,.katex .sizing.reset-size11.size11{font-size:1em}.katex .delimsizing.size1{font-family:KaTeX_Size1}.katex .delimsizing.size2{font-family:KaTeX_Size2}.katex .delimsizing.size3{font-family:KaTeX_Size3}.katex .delimsizing.size4{font-family:KaTeX_Size4}.katex .delimsizing.mult .delim-size1>span{font-family:KaTeX_Size1}.katex .delimsizing.mult .delim-size4>span{font-family:KaTeX_Size4}.katex .nulldelimiter{display:inline-block;width:.12em}.katex .delimcenter,.katex .op-symbol{position:relative}.katex .op-symbol.small-op{font-family:KaTeX_Size1}.katex .op-symbol.large-op{font-family:KaTeX_Size2}.katex .accent>.vlist-t,.katex .op-limits>.vlist-t{text-align:center}.katex .accent .accent-body{position:relative}.katex .accent .accent-body:not(.accent-full){width:0}.katex .overlay{display:block}.katex .mtable .vertical-separator{display:inline-block;min-width:1px}.katex .mtable .arraycolsep{display:inline-block}.katex .mtable .col-align-c>.vlist-t{text-align:center}.katex .mtable .col-align-l>.vlist-t{text-align:left}.katex .mtable .col-align-r>.vlist-t{text-align:right}.katex .svg-align{text-align:left}.katex svg{fill:currentColor;stroke:currentColor;fill-rule:nonzero;fill-opacity:1;stroke-width:1;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:4;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;display:block;height:inherit;position:absolute;width:100%}.katex svg path{stroke:none}.katex img{border-style:none;max-height:none;max-width:none;min-height:0;min-width:0}.katex .stretchy{display:block;overflow:hidden;position:relative;width:100%}.katex .stretchy:after,.katex .stretchy:before{content:""}.katex .hide-tail{overflow:hidden;position:relative;width:100%}.katex .halfarrow-left{left:0;overflow:hidden;position:absolute;width:50.2%}.katex .halfarrow-right{overflow:hidden;position:absolute;right:0;width:50.2%}.katex .brace-left{left:0;overflow:hidden;position:absolute;width:25.1%}.katex .brace-center{left:25%;overflow:hidden;position:absolute;width:50%}.katex .brace-right{overflow:hidden;position:absolute;right:0;width:25.1%}.katex .x-arrow-pad{padding:0 .5em}.katex .cd-arrow-pad{padding:0 .55556em 0 .27778em}.katex .mover,.katex .munder,.katex .x-arrow{text-align:center}.katex .boxpad{padding:0 .3em}.katex .fbox,.katex .fcolorbox{border:.04em solid;box-sizing:border-box}.katex .cancel-pad{padding:0 .2em}.katex .cancel-lap{margin-left:-.2em;margin-right:-.2em}.katex .sout{border-bottom-style:solid;border-bottom-width:.08em}.katex .angl{border-right:.049em solid;border-top:.049em solid;box-sizing:border-box;margin-right:.03889em}.katex .anglpad{padding:0 .03889em}.katex .eqn-num:before{content:"(" counter(katexEqnNo) ")";counter-increment:katexEqnNo}.katex .mml-eqn-num:before{content:"(" counter(mmlEqnNo) ")";counter-increment:mmlEqnNo}.katex .mtr-glue{width:50%}.katex .cd-vert-arrow{display:inline-block;position:relative}.katex .cd-label-left{display:inline-block;position:absolute;right:calc(50% + .3em);text-align:left}.katex .cd-label-right{display:inline-block;left:calc(50% + .3em);position:absolute;text-align:right}.katex-display{display:block;margin:1em 0;text-align:center}.katex-display>.katex{display:block;text-align:center;white-space:nowrap}.katex-display>.katex>.katex-html{display:block;position:relative}.katex-display>.katex>.katex-html>.tag{position:absolute;right:0}.katex-display.leqno>.katex>.katex-html>.tag{left:0;right:auto}.katex-display.fleqn>.katex{padding-left:2em;text-align:left}body{counter-reset:katexEqnNo mmlEqnNo}

/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

.katex-error {
	color: var(--vscode-editorError-foreground);
}

</style>
        
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/markdown.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Microsoft/vscode/extensions/markdown-language-features/media/highlight.css">
<style>
            body {
                font-family: -apple-system, BlinkMacSystemFont, 'Segoe WPC', 'Segoe UI', system-ui, 'Ubuntu', 'Droid Sans', sans-serif;
                font-size: 14px;
                line-height: 1.6;
            }
        </style>
        <style>
.task-list-item { list-style-type: none; } .task-list-item-checkbox { margin-left: -20px; vertical-align: middle; }
</style>
        
    </head>
    <body class="vscode-body vscode-light">
        <h1 id="tutorial-snake">Tutorial: Snake</h1>
<p>This tutorial will guide you through the creation of a simple Snake-style game with ECoS.</p>
<!--  ![ECoS Terminal](images/Terminal-initial.png) -->
<h2 id="making-the-graphics">Making the Graphics</h2>
<p>We'll start by making the graphics using the build in Image Editor.
To open this, type the command <code>IMAGE</code> in the Terminal and press <em>enter</em>.</p>
<p><img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Terminal-IMAGE-cmd.png" alt=""></p>
<p>(For information on how to use the Image Editor, see <a href="../Using-the-Image-Editor.html">Using the Image Editor</a>.)</p>
<p>For the game we're going to make, we'll be needing 4 images:</p>
<ol>
<li>The head of the snake.</li>
<li>A single segment of the body of the snake.</li>
<li>An icon for the collectable item. Throughout this tutorial, we'll be referring to this item as the &quot;apple&quot;.</li>
<li>A solid wall that the snake cannot move through.</li>
</ol>
<p>How you want these images to look is up to you, but for the sake of this tutorial, they'll each need to be a single tile (i.e. two sprites wide).</p>
<p>We're going to make use of flags later on when we get to writing the code, so we might as well configure them now.</p>
<blockquote>
<p><strong>Flags</strong>:<br>
Each sprite has an associated 8 bit flags that can be toggled on/off via the Image Editor.
These flags have no special functionality on their own, but can be useful to encode custom information on a per-game basis.</p>
</blockquote>
<p>For the game we'll be making, we're going to need two different flags:</p>
<ol>
<li>A flag to indicate that something is a collectable, which we'll use for the apple.</li>
<li>A flag to indicate that something is a solid obstacle, which we'll use for the wall tile.</li>
</ol>
<p>The image below shows the sprites used in this tutorial, along with the configured flags.<br>
<img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\ImageEditor-final-art.png" alt=""></p>
<p>Press <em>escape</em> to return to the Terminal.</p>
<h2 id="making-the-level">Making the Level</h2>
<p>Now that we have the graphics, it's time to set up the level using the Level Editor.
To open this, type the command <code>LEVEL</code> in the Terminal and press <em>enter</em>.</p>
<p><img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Terminal-LEVEL-cmd.png" alt=""></p>
<p>(For information on how to use the Level Editor, see <a href="../Using-the-Level-Editor.html">Using the Level Editor</a>.)</p>
<p>The level we'll be making in this tutorial is rather simple; all we technically need is a border around the edge of the display.
However, to make things a bit more interesting we're going to make it so that if the snake reaches the end of the screen it'll re-appear from the opposite side.
For this reason we'll want some gabs in this border.</p>
<p>It should be noted that we won't be using the first row, as this will be used to display the current score. Therefore, the border should start at the second row.
Also, to keep the code for this tutorial simple, the way we're going to spawn the apple when it's been eating won't work if we place any walls anywhere except for around the border.</p>
<p>The image below shows the level used in this tutorial.<br>
<img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\LevelEditor-final-layout.png" alt=""></p>
<p>Press <em>escape</em> to return to the Terminal.</p>
<h2 id="making-the-sound-effects-and-background-music">Making the Sound Effects and Background Music</h2>
<p>With the graphics and level in place, the last thing we'll make before we write the code is the sound effects and background music, which we'll make using the Synthesizer/Music Tracker.
To open this, type the command <code>SYNTH</code> in the Terminal and press <em>enter</em>.</p>
<p><img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Terminal-SYNTH-cmd.png" alt=""></p>
<p>(For information on how to use the Synthesizer/Music Tracker, see <a href="../Using-the-Synthesizer_Music-Tracker.html">Using the Synthesizer/Music Tracker</a>.)</p>
<p>We're going to need three sound effects, as well as a simple melody to loop in the background:</p>
<ol>
<li>
<p>The sound effect used when moving.<br>
<img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Synthesizer-sfx-move.png" alt=""></p>
</li>
<li>
<p>The sound effect used when an apple is eaten.<br>
<img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Synthesizer-sfx-eat.png" alt=""></p>
</li>
<li>
<p>The sound effect used on game over.<br>
<img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Synthesizer-sfx-die.png" alt=""></p>
</li>
<li>
<p>The melody playing in the background.<br>
<img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Tracker-melody.png" alt=""></p>
</li>
</ol>
<p>Press <em>escape</em> to return to the Terminal.</p>
<h2 id="writing-the-game-code">Writing the Game Code</h2>
<p>With everything else prepared, we're finally ready to write the code for our game using the build in Code Editor. To open this, type the command <code>EDIT Snake</code> in the Terminal and press <em>enter</em>.</p>
<p><img src="file:///c:\Users\mlj\Desktop\ECoS - Documentation\content\tutorial\images\Terminal-EDIT-Snake-cmd.png" alt=""></p>
<p>(For information on how to use the Code Editor, see <a href="../Using-the-Code-Editor.html">Using the Code Editor</a>.)</p>
<p>ECoS has a powerful Entity-Component-System architecture at its core.
This tutorial won't go into the details on this architecture, but the overall idea is that it splits all game code up into three overall concepts; <em>entities</em>, <em>components</em>, and <em>systems</em>.</p>
<p>An <strong>entity</strong> is the simplest of the concepts. Entities are essentially just collections of components that together represents a single &quot;object&quot; or &quot;thing&quot; in the game, such as the player character, or an enemy unit.</p>
<p>A <strong>component</strong> is essentially just some data. Components can either be single primitive values, such as a number or a string, or a Lua table containing closely related values representing a single &quot;concept&quot;/&quot;property&quot; of an entity. Examples of components could be the position of an entity, what sprite should be used to render it, how much health the entity has, etc.</p>
<p>A <strong>system</strong> is used to define the game logic and/or render graphics. In ECoS, a system is represented as a regular Lua function, that has been <em>registered</em> via one of the special system registration functions.
Three different kinds of systems exist:</p>
<ul>
<li>
<p><strong>Setup systems</strong>, which will be executed once at the beginning of the game.
These systems can be useful to set up the initial state of the game, such as creating the initial entities.
The special function <a href="../api/level-api/Level-Functions.html#setup-fn1"><code>SETUP( fn )</code></a> is used to register a setup system (where <code>fn</code> is the function to register).</p>
</li>
<li>
<p><strong>Update systems</strong>, which will be executed once each frame. These systems are where the game logic occurs.
The special function <a href="../api/level-api/Level-Functions.html#update-fn1"><code>UPDATE( fn )</code></a> is used to register an update system (where <code>fn</code> is the function to register).</p>
<blockquote>
<p>Note: It's common to split separate concepts into separate systems, such as a system to deal with moving the player entity, a separate system for handling collisions, etc.</p>
</blockquote>
</li>
<li>
<p><strong>Render systems</strong>, which will be executed once each frame, after the update systems have been executed.
These systems are where all the code related to drawing the content of the game should occur.
The special function <a href="../api/level-api/Level-Functions.html#draw-fn1"><code>DRAW( fn )</code></a> is used to register a render system (where <code>fn</code> is the function to register).</p>
</li>
</ul>
<h3 id="creating-the-setup-system">Creating the Setup System</h3>
<p>We'll start by defining an <em>entity template</em>, <code>T_BODY</code>, to represent a single segment of the snake's body.</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- Template for a single segment</span>
<span class="hljs-comment">-- of the snake&#x27;s body/tail</span>
<span class="hljs-keyword">local</span> T_BODY = {
  img = <span class="hljs-number">3</span>,
  pos = {x=<span class="hljs-number">8</span>, y=<span class="hljs-number">8</span>},
  target = {x=<span class="hljs-number">8</span>, y=<span class="hljs-number">8</span>},
} 
</div></code></pre>
<p>Each segment of the snake is going to be its own entity, so we'll use this template when creating new entities. That way, whenever we want to make the snake grow, all we need to do is create a new instance of this template and make it follow the snake.</p>
<p>Our <code>T_BODY</code> template consists of three components:</p>
<ol>
<li>
<p>An <code>img</code> component which stores the tile id we'll use to draw the body part with.</p>
</li>
<li>
<p>A <code>pos</code> component which stores the position of the body part (in tile coordinates).</p>
</li>
<li>
<p>A <code>target</code> component which is going to store the position that the body part should move to when the snake moves.</p>
</li>
</ol>
<p>Below the template we'll define a few variables we'll be needing throughout the code.</p>
<pre><code class="language-lua"><div><span class="hljs-keyword">local</span> tick,score,isDead
<span class="hljs-keyword">local</span> body,tail
</div></code></pre>
<p>Each of these will be used as follows:</p>
<ul>
<li>
<p><code>tick</code> will be used as a timer to limit how often the snake should move.</p>
</li>
<li>
<p><code>score</code> will be used to store the players current score.</p>
</li>
<li>
<p><code>isDead</code> will be used to keep track of whether the snake has died.
We'll use this to stop the game loop and display a &quot;Game Over&quot; message.</p>
</li>
<li>
<p><code>body</code> will be used to store a list of all the segments of the snake's body.
We'll use this list in our update system to check whether the snake's head has collided with it's body.</p>
</li>
<li>
<p><code>tail</code> will be used to hold a reference to the tail (i.e. last segment) of the snakes body.
We'll be needing this reference each time we grow the snake, to set up the new segment.</p>
</li>
</ul>
<ol>
<li>
<p>After the variables we have the following function:</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- Grows the snake by one</span>
<span class="hljs-comment">-- additional segment</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Grow</span><span class="hljs-params">()</span></span>
  <span class="hljs-keyword">local</span> part = NEW(T_BODY)
  part.pos.x = tail.pos.x
  part.pos.y = tail.pos.y
  part.prev = tail
  tail = part
  body[#body+<span class="hljs-number">1</span>] = part.pos
<span class="hljs-keyword">end</span>
</div></code></pre>
<p>This function will be used to grow the snake, by appending a new segment to the end of the snakes body.</p>
<ol>
<li>
<p>First, we use the <a href="../api/level-api/Level-Functions.html#new-template"><code>NEW</code></a> function to create a new entity based on our <code>T_BODY</code> template.</p>
</li>
<li>
<p>Next, we set the position of the segment to the position of the snake's current tail.</p>
</li>
<li>
<p>After this, we add a new component <code>prev</code> to the entity, which is going to be a reference to the previous tail of the snake. This will allow us to easily get the position of that segment when we want to move the snake, greatly simplifying the movement code.</p>
</li>
<li>
<p>Finally we make sure to update <code>tail</code> to the new segment, and add it to our <code>body</code> list.</p>
</li>
</ol>
</li>
</ol>
<p>Following this function we have the start of our setup system.</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- SETUP is used to register a</span>
<span class="hljs-comment">-- function that should only run</span>
<span class="hljs-comment">-- once when the game starts</span>
SETUP(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span></span>
  score = <span class="hljs-number">0</span>
  body = {}
  tail = NEW{
    pos = {x=<span class="hljs-number">8</span>, y=<span class="hljs-number">8</span>},
    dir = {x=<span class="hljs-number">0</span>,y=<span class="hljs-number">0</span>},
    img = <span class="hljs-number">1</span>,
  }
...
</div></code></pre>
<p>Here, we're setting up the initial values of our variables.
Note how the <a href="../api/level-api/Level-Functions.html#new-template"><code>NEW</code></a> function is used to create a new entity with a <code>pos</code>, <code>dir</code> and <code>img</code> component. This entity is going to represent the head of the snake. Unlike the rest of the snake, this entity doesn't have a <code>target</code> component; instead it has a <code>dir</code> component which we'll use to keep track of which direction the snake is currently moving.</p>
<p>We want the snake to have a small body from the beginning, so that it doesn't start out as a disembodied head. Luckily, all we need to do to give it a body is to call our <code>Grow</code> function a couple of times, to add a few segments to the body.</p>
<pre><code class="language-lua"><div>...
  Grow()
  Grow()
...
</div></code></pre>
<p>The last thing we need to do in out setup system is to spawn the apple, and start the background music.</p>
<pre><code class="language-lua"><div>...
  <span class="hljs-keyword">local</span> x,y = RND(<span class="hljs-number">1</span>,<span class="hljs-number">14</span>), RND(<span class="hljs-number">2</span>,<span class="hljs-number">14</span>)
  <span class="hljs-keyword">if</span> x == <span class="hljs-number">8</span> <span class="hljs-keyword">and</span> y == <span class="hljs-number">8</span> <span class="hljs-keyword">then</span> x = <span class="hljs-number">2</span> <span class="hljs-keyword">end</span>
  MAP(x,y, <span class="hljs-number">5</span>)
  SNDL(<span class="hljs-number">4</span>)
<span class="hljs-keyword">end</span>)
</div></code></pre>
<ol>
<li>We start by picking a random <code>x</code> and <code>y</code> position. For the x-coordinate we'll pick a random number between 1 and 14 (since the entire screen is 16 tiles wide and we don't want to spawn the apple on the border). Similarly, for the y-coordinate we'll pick a random number between 2 and 14 (since the entire screen is 16 tiles tall and we don't want to spawn the apple on the border, nor should it spawn inside the part of the screen where we show the score).</li>
<li>Our snake starts out at position <code>{x = 8, y = 8}</code>, so to make sure we don't spawn the apple directly inside the snake's head, we check to see if the randomly picked tile position is equal to this, in which case we move it to a different spot.</li>
<li>Once we have the random position for the apple, we use the <a href="../api/level-api/Level-Functions.html#map-x-y"><code>MAP</code></a> function to override the tile at that location in the level with our apple tile (id <code>5</code>).</li>
<li>Finally, we use <a href="../api/Sound-API.html#sndl-id"><code>SNDL</code></a> to start our background music (id <code>4</code>) playing in a loop.</li>
</ol>
<h3 id="processing-input">Processing Input</h3>
<p>Before we write the actual update system, we'll define the functions we're going to be using within it. Several of these functions could technically be defined as their own update systems, but to be able to easily disable them when the snake dies, we'll instead be calling them from within a single update system.</p>
<p>The first function we'll define is going to handle the user input.</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- Handles key input</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ProcessInput</span><span class="hljs-params">()</span></span>
  <span class="hljs-keyword">for</span> _, dir <span class="hljs-keyword">in</span> ALL(<span class="hljs-string">&quot;dir&quot;</span>) <span class="hljs-keyword">do</span>
        <span class="hljs-keyword">if</span> KEY<span class="hljs-string">&quot;U&quot;</span> <span class="hljs-keyword">and</span> dir.y ~=  <span class="hljs-number">1</span> <span class="hljs-keyword">then</span> dir.x =  <span class="hljs-number">0</span> dir.y = <span class="hljs-number">-1</span> tick = tick <span class="hljs-keyword">or</span> <span class="hljs-number">-1</span>
    <span class="hljs-keyword">elseif</span> KEY<span class="hljs-string">&quot;D&quot;</span> <span class="hljs-keyword">and</span> dir.y ~= <span class="hljs-number">-1</span> <span class="hljs-keyword">then</span> dir.x =  <span class="hljs-number">0</span> dir.y =  <span class="hljs-number">1</span> tick = tick <span class="hljs-keyword">or</span> <span class="hljs-number">-1</span>
    <span class="hljs-keyword">elseif</span> KEY<span class="hljs-string">&quot;L&quot;</span> <span class="hljs-keyword">and</span> dir.x ~=  <span class="hljs-number">1</span> <span class="hljs-keyword">then</span> dir.x = <span class="hljs-number">-1</span> dir.y =  <span class="hljs-number">0</span> tick = tick <span class="hljs-keyword">or</span> <span class="hljs-number">-1</span>
    <span class="hljs-keyword">elseif</span> KEY<span class="hljs-string">&quot;R&quot;</span> <span class="hljs-keyword">and</span> dir.x ~= <span class="hljs-number">-1</span> <span class="hljs-keyword">then</span> dir.x =  <span class="hljs-number">1</span> dir.y =  <span class="hljs-number">0</span> tick = tick <span class="hljs-keyword">or</span> <span class="hljs-number">-1</span> <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</div></code></pre>
<p>Here we're using the <a href="../api/level-api/Level-Functions.html#all-class-"><code>ALL</code></a> function to iterate through all entities with a <code>dir</code> component, using the <a href="../api/Input-API.html#key-key"><code>KEY</code></a> function to check which direction the player is pressing and updating the <code>dir</code> accordingly. We also make sure to initialize <code>tick</code> to <code>-1</code> if it wasn't already initialized. Doing so will allow us to wait for the first button to be pressed before we start running out <code>tick</code> counter.</p>
<blockquote>
<p>You might be wondering why we're using a for-loop to achieve what is essentially just updating the <code>dir</code> component on the head of the snake, when we could have just kept a direct reference to it instead. Indeed, either approach would work just fine in this case, however, there are some advantages to doing it this way instead:</p>
<ul>
<li>When using a direct reference, the reference has to always remain valid. With the way we're going to write the code in this tutorial this wouldn't a problem, but for more complex games, it can sometimes be hard to ensure that a reference to an entity is always valid.</li>
<li>Using the <code>ALL</code> function decouples the behavior from any single entity, making it much easier to later change the game to have more than one snake.
In fact, in most Entity-Component-Systems, the behavior of the <code>ALL</code> function is an integrated part of how the systems work, in the sense that you'd register a system based on what components it requires, with the system itself being a function that takes an entity and the requested components as argument.</li>
</ul>
</blockquote>
<h3 id="changing-to-the-game-over-state">Changing to the Game Over State</h3>
<p>We're going to need a easy way to enable the &quot;Game Over&quot; state. For this, we'll make a function, <code>GameOver</code>.</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- Called when the snake hits</span>
<span class="hljs-comment">-- its tail to end the game</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GameOver</span><span class="hljs-params">()</span></span>
  isDead = <span class="hljs-literal">true</span>
  SND(<span class="hljs-number">-1</span>)
  SND(<span class="hljs-number">3</span>)
<span class="hljs-keyword">end</span>
</div></code></pre>
<p>This function does three simple things:</p>
<ol>
<li>It sets our <code>isDead</code> variable to <code>true</code>, to indicate that we're in the &quot;Game Over&quot; state.</li>
<li>It stops all sounds and music from playing, using <a href="../api/Sound-API.md#snd--1"><code>SND(-1)</code></a>.</li>
<li>It plays the death sound effect (id <code>3</code>) once, using <a href="../api/Sound-API.md#snd-id"><code>SND</code></a>.</li>
</ol>
<h3 id="moving-the-apple">Moving the Apple</h3>
<p>Another feature we're going to need is the ability to move the apple once it's been eaten.
For this, we'll write the following function, which sets the tile at the specified position to id <code>0</code> and changes a random tile within the border to the apple tile (id <code>5</code>).</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- Changes the position of the</span>
<span class="hljs-comment">-- &quot;apple&quot; to a random location</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MoveApple</span><span class="hljs-params">(x,y)</span></span>
  MAP(x, y, <span class="hljs-number">0</span>)
  MAP(RND(<span class="hljs-number">1</span>,<span class="hljs-number">14</span>), RND(<span class="hljs-number">2</span>,<span class="hljs-number">14</span>), <span class="hljs-number">5</span>)
<span class="hljs-keyword">end</span>
</div></code></pre>
<h3 id="moving-the-snakes-body">Moving the Snake's Body</h3>
<p>The next function we'll define is going to be in charge of moving the snake's body.</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- moves the segments of the</span>
<span class="hljs-comment">-- snakes body</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MoveBodyParts</span><span class="hljs-params">()</span></span>
  <span class="hljs-keyword">for</span> _, prev, target
  <span class="hljs-keyword">in</span> ALL(<span class="hljs-string">&quot;prev&quot;</span>, <span class="hljs-string">&quot;target&quot;</span>) <span class="hljs-keyword">do</span>
    target.x = prev.pos.x
    target.y = prev.pos.y
  <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">for</span> _, pos, target 
  <span class="hljs-keyword">in</span> ALL(<span class="hljs-string">&quot;pos&quot;</span>, <span class="hljs-string">&quot;target&quot;</span>) <span class="hljs-keyword">do</span>
    pos.x = target.x
    pos.y = target.y
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</div></code></pre>
<p>The function works in two steps:</p>
<ol>
<li>First, it iterates through all entities with a <code>prev</code> and <code>target</code> component (which corresponds with each of the snake's body segments), and updates the coordinates of the <code>target</code> component to that of the previous segments position.</li>
<li>Next, it iterates through all entities with a <code>pos</code> and <code>target</code> component (which, again, corresponds with each of the snake's body segments), and updates the position to that of the now updated target position.</li>
</ol>
<p>This way, each segment's position will have updated to the previous position of the segment before it, giving us the snake-like movment behavior we're interested in.</p>
<h3 id="moving-the-snakes-head">Moving the Snake's Head</h3>
<p>Moving the snake's head is a bit more involved than simply changing it's position; we also need to have the case where it wraps to the opposite site of the screen, as well as handle the cases where the snake moves into an apple or a wall.</p>
<p>We start by iterating over all entities with a <code>pos</code> and <code>dir</code> component (of which there'll only only be a single entity, namely the snake's head).</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- moves the head of the snake</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">MoveHead</span><span class="hljs-params">()</span></span>
  <span class="hljs-keyword">for</span> _, pos, dir
  <span class="hljs-keyword">in</span> ALL(<span class="hljs-string">&quot;pos&quot;</span>, <span class="hljs-string">&quot;dir&quot;</span>) <span class="hljs-keyword">do</span>
...
</div></code></pre>
<p>Next, we'll use <a href="../api/Sound-API.html#snd-id"><code>SND</code></a> to play our movement sound effect (id <code>1</code>) .</p>
<pre><code class="language-lua"><div>...
    SND(<span class="hljs-number">1</span>)
...
</div></code></pre>
<p>After this we'll handle the actual movement of the head, including the wrapping at the screen edges.</p>
<pre><code class="language-lua"><div>...
    <span class="hljs-keyword">local</span> x,y
    x = OVFW(pos.x + dir.x, <span class="hljs-number">0</span>,<span class="hljs-number">15</span>)
    y = OVFW(pos.y + dir.y, <span class="hljs-number">1</span>,<span class="hljs-number">15</span>)
    pos.x = x
    pos.y = y
...
</div></code></pre>
<p>Here, we're using the <a href="../api/math-api/General-Math-Functions.html#ovfw-n-min-max"><code>OVFW</code></a> function to handle the wrapping and update the position of the head. Note that we're also storing the coordinates of the new position in the local variables <code>x</code> and <code>y</code> for use throughout the rest of the function.</p>
<p>After this we'll write the code that'll handle colliding with an apple or a wall tile.</p>
<pre><code class="language-lua"><div>...
    <span class="hljs-comment">-- check whether the head</span>
    <span class="hljs-comment">-- is on top of an apple</span>
    <span class="hljs-comment">-- or inside a wall</span>
    <span class="hljs-keyword">local</span> tile = MAP(x,y)
    <span class="hljs-keyword">if</span> FLG(tile,<span class="hljs-number">0x01</span>) <span class="hljs-keyword">then</span>
      SND(<span class="hljs-number">2</span>)
      score = score + <span class="hljs-number">100</span>
      MoveApple(x,y)
      Grow()
    <span class="hljs-keyword">elseif</span> FLG(tile, <span class="hljs-number">0x02</span>) <span class="hljs-keyword">then</span>
      GameOver()
    <span class="hljs-keyword">end</span>
...
</div></code></pre>
<p>Here, we're using the <a href="../api/level-api/Level-Functions.html#map-x-y"><code>MAP</code></a> function to retrieve the id of the tile below the head.
We then use the <a href="../api/level-api/Level-Functions.html#flg-id-mask"><code>FLG</code></a> function to check whether the tile is an apple (indicated by bit flag 1).
If it is, we then;</p>
<ul>
<li>play the eating sound effect (id <code>2</code>), using the <a href="../api/Sound-API.html#snd-id"><code>SND</code></a> function,</li>
<li>increase the score by <code>100</code> points,</li>
<li>move the apple to a new random location, using our <code>MoveApple</code> function, and</li>
<li>make the snake grow by another segment, using our <code>Grow</code> function.</li>
</ul>
<p>Otherwise, if the tile was not an apple, we check to see if it's a wall tile (indicated by bit flag 2), and if so, we call our <code>GameOver</code> function to end the game loop.</p>
<p>The last part of our function will be concerned with testing whether the snake has collided with itself.</p>
<pre><code class="language-lua"><div>...
    <span class="hljs-comment">-- check whether the head</span>
    <span class="hljs-comment">-- overlaps part of the body</span>
    <span class="hljs-keyword">for</span> _,part <span class="hljs-keyword">in</span> ITER(body) <span class="hljs-keyword">do</span>
      <span class="hljs-keyword">if</span> pos.x == part.x
      <span class="hljs-keyword">and</span> pos.y == part.y <span class="hljs-keyword">then</span>
        GameOver()
      <span class="hljs-keyword">end</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</div></code></pre>
<p>Here, we iterate through each of the segments in out <code>body</code> list, using the <a href="../api/Utility-Functions.md#iter-t"><code>ITER</code></a> utility function, to see if the position corresponds to that of the head; if so, we use our <code>GameOver</code> function to end the game loop.</p>
<h3 id="creating-the-update-system">Creating the Update System</h3>
<p>With all the helper functions already defined, writing the actual update system is rather straight forward.</p>
<p>First we check to make sure the snake has died; if so, we''ll simply return from the update system, as we don't want any logic to run in this case.</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- UPDATE is used to register</span>
<span class="hljs-comment">-- a function that should be</span>
<span class="hljs-comment">-- called once each frame to</span>
<span class="hljs-comment">-- update the game logic</span>
UPDATE(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span></span>
  <span class="hljs-comment">-- don&#x27;t update logic if the</span>
  <span class="hljs-comment">-- snake is dead</span>
  <span class="hljs-keyword">if</span> isDead <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">end</span>
...
</div></code></pre>
<p>Next, we'll use our <code>ProcessInput</code> function to handle the players input and update the direction of the head.</p>
<pre><code class="language-lua"><div>...
  ProcessInput()
...
</div></code></pre>
<p>After this, we'll check to see if <code>tick</code> has been initialized (meaning that the snake should be moving), and if so we'll update it. We're going to have it loop over each time it's counted to 15, which will result in the snake moving 4 times per second.</p>
<pre><code class="language-lua"><div>...
  <span class="hljs-keyword">if</span> <span class="hljs-keyword">not</span> tick <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">end</span>
  tick = (tick + <span class="hljs-number">1</span>) % <span class="hljs-number">15</span>
  <span class="hljs-keyword">if</span> tick &gt; <span class="hljs-number">0</span> <span class="hljs-keyword">then</span> <span class="hljs-keyword">return</span> <span class="hljs-keyword">end</span>
...
</div></code></pre>
<p>Finally, if the <code>tick</code> is equal to <code>0</code>, we call our movement functions to move the body and head of the snake.</p>
<pre><code class="language-lua"><div>...
  MoveBodyParts()
  MoveHead()
<span class="hljs-keyword">end</span>)
</div></code></pre>
<h3 id="creating-the-render-system">Creating the Render System</h3>
<p>The last system we need to create is our render system. This system will consist of four parts; drawing the tiles in the level, drawing the entities, printing the score, and showing a &quot;Game Over&quot; message when the snake has died.</p>
<p>We'll start by iterating through the visible tiles using a nested for-loop. In it, we'll use the <a href="../api/level-api/Level-Functions.html#map-x-y"><code>Map</code></a> function to get the tile, which we can then draw using the <a href="../api/Graphics-API.html#tile-id-x-y"><code>TILE</code></a> function.</p>
<pre><code class="language-lua"><div><span class="hljs-comment">-- DRAW is used to register a</span>
<span class="hljs-comment">-- a function that should be</span>
<span class="hljs-comment">-- called each time the virtual</span>
<span class="hljs-comment">-- display is redrawn</span>
DRAW(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span></span>
  <span class="hljs-comment">-- draws the background tiles</span>
  <span class="hljs-keyword">for</span> y=<span class="hljs-number">0</span>,<span class="hljs-number">15</span> <span class="hljs-keyword">do</span>
    <span class="hljs-keyword">for</span> x=<span class="hljs-number">0</span>,<span class="hljs-number">15</span> <span class="hljs-keyword">do</span>
      TILE(MAP(x,y), x*<span class="hljs-number">8</span>,y*<span class="hljs-number">8</span>)
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
...
</div></code></pre>
<p>Next, we'll iterate through all entities with a <code>&quot;pos&quot;</code> and <code>&quot;img&quot;</code> component using the <a href="../api/level-api/Level-Functions.html#all-class"><code>ALL</code></a> function, and draw them with the <a href="../api/Graphics-API.html#tile-id-x-y"><code>TILE</code></a> function.</p>
<pre><code class="language-lua"><div>...
  <span class="hljs-comment">-- draws all entities</span>
  <span class="hljs-keyword">for</span> _, pos, img
  <span class="hljs-keyword">in</span> ALL(<span class="hljs-string">&quot;pos&quot;</span>, <span class="hljs-string">&quot;img&quot;</span>) <span class="hljs-keyword">do</span>
    TILE(img, pos.x*<span class="hljs-number">8</span>, pos.y*<span class="hljs-number">8</span>)
  <span class="hljs-keyword">end</span>
...
</div></code></pre>
<p>Next we'll use the <a href="../api/Graphics-API.html#txt-str-x-y-clear"><code>TXT</code></a> function to print the current score at the top of the screen.</p>
<pre><code class="language-lua"><div>...
  <span class="hljs-comment">-- prints the current score</span>
  TXT(<span class="hljs-string">&quot;Score &quot;</span>..score, <span class="hljs-number">0</span>,<span class="hljs-number">0</span>, <span class="hljs-literal">true</span>)
...
</div></code></pre>
<p>Finally, we'll check to see if the player has died; if so, we'll use the <a href="../api/Graphics-API.html#txt-str-x-y-clear"><code>TXT</code></a> function to show a simple &quot;Game Over&quot; message.</p>
<pre><code class="language-lua"><div>...
  <span class="hljs-comment">-- shows death message if dead</span>
  <span class="hljs-keyword">if</span> isDead <span class="hljs-keyword">then</span>
    TXT(<span class="hljs-string">&quot;  GAME OVER  &quot;</span>, <span class="hljs-number">38</span>,<span class="hljs-number">60</span>, <span class="hljs-literal">true</span>)
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>)
</div></code></pre>

        
        
    </body>
    </html>